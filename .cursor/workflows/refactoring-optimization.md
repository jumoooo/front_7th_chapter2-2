# 리팩토링 및 최적화 워크플로우

## 📋 개요

이 워크플로우는 코드 리팩토링이나 최적화 작업을 수행할 때 AI 에이전트가 따라야 하는 단계별 프로세스를 정의합니다.

## 🎯 사용 시나리오

- 특정 함수나 모듈의 리팩토링 요청
- 성능 최적화 요청
- 코드 품질 개선 요청
- 중복 코드 제거 요청

## 🔄 워크플로우 단계

### 1단계: 현재 상태 분석 (Current State Analysis)

**목표**: 리팩토링/최적화 대상 코드를 이해합니다.

**작업 내용**:
- [ ] 대상 파일 및 함수 읽기
- [ ] 코드 구조 및 로직 파악
- [ ] 의존성 확인 (다른 파일/함수와의 관계)
- [ ] 테스트 커버리지 확인
- [ ] 성능 병목 지점 식별 (최적화의 경우)

**출력물**:
- 현재 코드 구조 요약
- 개선이 필요한 부분 식별
- 리팩토링/최적화 목표 설정

---

### 2단계: 리팩토링/최적화 계획 수립 (Planning)

**목표**: 어떻게 개선할지 계획을 세웁니다.

**작업 내용**:
- [ ] 개선 방향 결정
  - 코드 중복 제거
  - 함수 분리
  - 타입 안전성 개선
  - 성능 최적화
- [ ] 변경 범위 확인
  - 어떤 파일을 수정할지
  - 어떤 함수를 변경할지
  - 영향받는 다른 코드 확인
- [ ] 테스트 전략 수립
  - 기존 테스트가 통과하는지 확인
  - 새로운 테스트가 필요한지 확인

**출력물**:
- 리팩토링/최적화 계획
- 변경할 파일 및 함수 목록
- 예상되는 개선 사항

---

### 3단계: 점진적 리팩토링 (Incremental Refactoring)

**목표**: 작은 단계로 안전하게 리팩토링합니다.

**작업 내용**:
- [ ] 작은 변경부터 시작
  - 한 번에 하나의 함수나 모듈만 수정
  - 큰 변경은 여러 단계로 나누기
- [ ] 기능 유지 확인
  - 리팩토링 후에도 동일한 동작 보장
  - 테스트 실행하여 확인
- [ ] 코드 품질 개선
  - 가독성 향상
  - 중복 제거
  - 타입 안전성 개선
  - 명확한 변수명/함수명 사용

**출력물**:
- 수정된 코드
- 변경 사항 설명
- 테스트 결과

---

### 4단계: 검증 및 최종 확인 (Verification)

**목표**: 리팩토링/최적화가 올바르게 완료되었는지 확인합니다.

**작업 내용**:
- [ ] 테스트 실행
  - 모든 기존 테스트 통과 확인
  - 새로운 테스트 추가 (필요한 경우)
- [ ] 코드 품질 확인
  - 린터 오류 없음
  - 타입 체크 통과
  - 코드 스타일 일관성
- [ ] 성능 확인 (최적화의 경우)
  - 성능 개선 여부 확인
  - 메모리 사용량 확인
  - 회귀 없음 확인

**출력물**:
- 테스트 실행 결과
- 코드 품질 메트릭
- 성능 개선 결과 (해당하는 경우)

---

## 📝 체크리스트

### 리팩토링 체크리스트

- [ ] 모든 기존 테스트 통과
- [ ] 새로운 린터 오류 없음
- [ ] 타입 안전성 유지 또는 개선
- [ ] 코드 가독성 향상
- [ ] 중복 코드 제거
- [ ] 함수/변수명 명확성 개선
- [ ] 문서 업데이트 (필요한 경우)

### 최적화 체크리스트

- [ ] 성능 병목 지점 정확히 식별
- [ ] 최적화가 코드 가독성을 해치지 않음
- [ ] 테스트로 최적화 정확성 검증
- [ ] 엣지 케이스 여전히 올바르게 처리
- [ ] 메모리 사용량 고려

---

## 🎯 리팩토링 패턴

### 1. 함수 추출 (Extract Function)

**언제 사용**: 긴 함수를 작은 함수로 분리

**방법**:
- 의미 있는 단위로 로직 분리
- 명확한 함수명 사용
- 단일 책임 원칙 준수

### 2. 중복 제거 (Remove Duplication)

**언제 사용**: 동일한 로직이 여러 곳에 반복됨

**방법**:
- 공통 로직을 함수로 추출
- 유틸리티 함수 생성
- 재사용 가능한 컴포넌트 생성

### 3. 타입 안전성 개선

**언제 사용**: `any` 타입이나 타입 단언이 과도함

**방법**:
- 적절한 타입 정의
- 타입 가드 사용
- `unknown` 활용

### 4. 성능 최적화

**언제 사용**: 성능 병목이 확인됨

**방법**:
- 불필요한 재계산 방지 (메모이제이션)
- DOM 조작 최소화
- 배치 업데이트 사용

---

## 💡 주의사항

1. **점진적 접근**: 한 번에 너무 많이 변경하지 않기
2. **테스트 우선**: 각 단계마다 테스트 실행
3. **기능 유지**: 리팩토링은 동작을 바꾸지 않아야 함
4. **문서화**: 복잡한 변경은 주석으로 설명

---

## 📚 관련 규칙

이 워크플로우는 다음 규칙 파일들과 연계됩니다:

- `.cursor/rules/refactoring-optimization.mdc` - 리팩토링 상세 규칙
- `.cursor/rules/code-style.mdc` - 코드 스타일 규칙
- `.cursor/rules/test-driven-development.mdc` - 테스트 기반 개발 규칙
- `.cursor/rules/handoff-documentation.mdc` - 인수인계 문서 규칙

