# Test-Driven Development Rules

## For AI Agent

### Test-First Approach

- When fixing test failures, understand the test expectation first
- Tests define the expected behavior - implementation should satisfy tests
- Never modify test files unless explicitly requested by user
- Use tests as specification and validation

### Test Analysis

- Read test cases carefully to understand:
  - What input is provided
  - What output is expected
  - What edge cases are covered
  - What structure is required

- For `it.each` parameterized tests:
  - Understand the pattern across all test cases
  - Ensure implementation handles all variations
  - Don't just fix one case - fix the underlying issue

### Test Execution

- Run tests after making changes: `pnpm test` or `pnpm test:basic`
- Verify all related tests pass, not just the failing one
- Check that no regressions are introduced
- If multiple tests fail, identify the common root cause

### Test Structure Understanding

- `describe` blocks group related tests
- `it.each` runs the same test with different inputs
- `expect().toEqual()` checks deep equality
- `expect.any(Function)` matches any function type
- Test data structure should match expected VNode structure exactly

### Implementation Requirements from Tests

- Match exact structure expected by tests
- Handle all input types shown in test cases
- Support all edge cases tested
- Return correct types and shapes
- Follow the exact VNode structure: `{ type, key, props: { children, ... } }`

### Common Test Patterns in This Project

1. **Element Creation Tests**
   - Test `createElement` output structure
   - Verify children normalization
   - Check key extraction and removal

2. **Normalization Tests**
   - Test `normalizeNode` with various input types
   - Verify null/undefined/boolean filtering
   - Check array flattening and filtering

3. **JSX Transformation Tests**
   - Verify JSX compiles to correct `createElement` calls
   - Test component rendering
   - Check conditional rendering

4. **Edge Case Tests**
   - Null/undefined handling
   - Empty arrays
   - Nested structures
   - Mixed types

### Fixing Test Failures

1. **Read the failing test** - understand what it expects
2. **Read current implementation** - see what it actually does
3. **Identify the gap** - what's missing or incorrect
4. **Fix the implementation** - make it match the expectation
5. **Run tests** - verify the fix works
6. **Check related tests** - ensure no regressions

### Test File Protection

- **NEVER** modify test files unless user explicitly requests it
- If user says "don't modify test files", that's a hard constraint
- Tests are the specification - they define correctness
- Only modify implementation files to make tests pass

---

## ì‚¬ìš©ììš© ì„¤ëª…

### ğŸ§ª í…ŒìŠ¤íŠ¸ ìš°ì„  ì ‘ê·¼ë²•

- í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ìˆ˜ì • ì‹œ, ë¨¼ì € í…ŒìŠ¤íŠ¸ ê¸°ëŒ€ê°’ì„ ì´í•´í•©ë‹ˆë‹¤
- í…ŒìŠ¤íŠ¸ê°€ ê¸°ëŒ€ ë™ì‘ì„ ì •ì˜í•©ë‹ˆë‹¤ - êµ¬í˜„ì€ í…ŒìŠ¤íŠ¸ë¥¼ ë§Œì¡±í•´ì•¼ í•©ë‹ˆë‹¤
- ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ ìš”ì²­í•˜ì§€ ì•ŠëŠ” í•œ í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
- í…ŒìŠ¤íŠ¸ë¥¼ ëª…ì„¸ì„œ ë° ê²€ì¦ ë„êµ¬ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤

### ğŸ“Š í…ŒìŠ¤íŠ¸ ë¶„ì„

- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì£¼ì˜ ê¹Šê²Œ ì½ì–´ ë‹¤ìŒì„ ì´í•´í•©ë‹ˆë‹¤:
  - ì–´ë–¤ ì…ë ¥ì´ ì œê³µë˜ëŠ”ì§€
  - ì–´ë–¤ ì¶œë ¥ì´ ê¸°ëŒ€ë˜ëŠ”ì§€
  - ì–´ë–¤ ì—£ì§€ ì¼€ì´ìŠ¤ê°€ ë‹¤ë¤„ì§€ëŠ”ì§€
  - ì–´ë–¤ êµ¬ì¡°ê°€ í•„ìš”í•œì§€

- `it.each` ë§¤ê°œë³€ìˆ˜í™”ëœ í…ŒìŠ¤íŠ¸ì˜ ê²½ìš°:
  - ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì— ê±¸ì¹œ íŒ¨í„´ ì´í•´
  - êµ¬í˜„ì´ ëª¨ë“  ë³€í˜•ì„ ì²˜ë¦¬í•˜ëŠ”ì§€ í™•ì¸
  - í•œ ì¼€ì´ìŠ¤ë§Œ ìˆ˜ì •í•˜ì§€ ë§ê³  ê·¼ë³¸ ë¬¸ì œë¥¼ ìˆ˜ì •

### âœ… í…ŒìŠ¤íŠ¸ ì‹¤í–‰

- ë³€ê²½ í›„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰: `pnpm test` ë˜ëŠ” `pnpm test:basic`
- ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸ë¿ë§Œ ì•„ë‹ˆë¼ ê´€ë ¨ëœ ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ëŠ”ì§€ í™•ì¸
- íšŒê·€ê°€ ë„ì…ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸
- ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•˜ë©´ ê³µí†µ ê·¼ë³¸ ì›ì¸ ì‹ë³„

### ğŸ¯ í…ŒìŠ¤íŠ¸ êµ¬ì¡° ì´í•´

- `describe` ë¸”ë¡ì€ ê´€ë ¨ í…ŒìŠ¤íŠ¸ë¥¼ ê·¸ë£¹í™”í•©ë‹ˆë‹¤
- `it.each`ëŠ” ë‹¤ë¥¸ ì…ë ¥ìœ¼ë¡œ ë™ì¼í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤
- `expect().toEqual()`ì€ ê¹Šì€ ë™ë“±ì„±ì„ í™•ì¸í•©ë‹ˆë‹¤
- `expect.any(Function)`ì€ ëª¨ë“  í•¨ìˆ˜ íƒ€ì…ê³¼ ì¼ì¹˜í•©ë‹ˆë‹¤
- í…ŒìŠ¤íŠ¸ ë°ì´í„° êµ¬ì¡°ëŠ” ê¸°ëŒ€ VNode êµ¬ì¡°ì™€ ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤

### ğŸ”§ í…ŒìŠ¤íŠ¸ì—ì„œ ìš”êµ¬í•˜ëŠ” êµ¬í˜„ ì‚¬í•­

- í…ŒìŠ¤íŠ¸ì—ì„œ ê¸°ëŒ€í•˜ëŠ” ì •í™•í•œ êµ¬ì¡° ì¼ì¹˜
- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì— í‘œì‹œëœ ëª¨ë“  ì…ë ¥ íƒ€ì… ì²˜ë¦¬
- í…ŒìŠ¤íŠ¸ëœ ëª¨ë“  ì—£ì§€ ì¼€ì´ìŠ¤ ì§€ì›
- ì˜¬ë°”ë¥¸ íƒ€ì…ê³¼ í˜•íƒœ ë°˜í™˜
- ì •í™•í•œ VNode êµ¬ì¡° ë”°ë¥´ê¸°: `{ type, key, props: { children, ... } }`

### ğŸš« í…ŒìŠ¤íŠ¸ íŒŒì¼ ë³´í˜¸

- ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ ìš”ì²­í•˜ì§€ ì•ŠëŠ” í•œ í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ **ì ˆëŒ€** ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
- "í…ŒìŠ¤íŠ¸ íŒŒì¼ì€ ìˆ˜ì •í•˜ì§€ ë§ˆë¼"ëŠ” ì§€ì‹œëŠ” ì—„ê²©í•œ ì œì•½ì…ë‹ˆë‹¤
- í…ŒìŠ¤íŠ¸ëŠ” ëª…ì„¸ì„œì…ë‹ˆë‹¤ - ì •í™•ì„±ì„ ì •ì˜í•©ë‹ˆë‹¤
- í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼ì‹œí‚¤ê¸° ìœ„í•´ êµ¬í˜„ íŒŒì¼ë§Œ ìˆ˜ì •í•©ë‹ˆë‹¤
